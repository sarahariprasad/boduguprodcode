{% extends "base.html" %}
{% load static %}

{% block title %}Board of Trustees | MyWebsite{% endblock %}

{% block content %}

<div class="container" style="padding-top: 120px; padding-bottom: 100px; max-width: 700px;">
    <!-- Modern Card -->
    <div class="card registration-card">
        <div class="card-body p-4">
            <!-- Card Heading -->
            <div class="text-center mb-4">
                <h2 class="card-title">Registration Form</h2>
                <hr>
            </div>

            <!-- Messages -->
            {% if messages %}
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                {% endfor %}
            {% endif %}

            <!-- Form -->
            <form method="POST" enctype="multipart/form-data">
                {% csrf_token %}

                <!-- Name & Mobile -->
                <div class="row">
                    <div class="form-group col-md-6 col-sm-12">
                        <label>Name</label>
                        <input type="text" name="name" class="form-control" required>
                    </div>
                    <div class="form-group col-md-6 col-sm-12">
                        <label>Mobile</label>
                        <input type="text" name="mobile" class="form-control" required>
                    </div>
                </div>

                <!-- Aadhaar & Email -->
                <div class="row">
                    <div class="form-group col-md-6 col-sm-12">
                        <label>Aadhaar Number</label>
                        <input type="text" name="adhar_number" class="form-control" maxlength="12" required>
                    </div>
                    <div class="form-group col-md-6 col-sm-12">
                        <label>Email</label>
                        <input type="email" name="email" class="form-control" required>
                    </div>
                </div>

                <!-- Aadhaar Upload -->
                <div class="form-group">
                    <label>Aadhaar Upload</label>
                    <input type="file" name="adhar_upload" class="form-control" required>
                </div>

                <!-- Dropdowns: Village, Mandal, District, Domain, SubDomain -->
                <div class="row">
                    <div class="form-group col-md-6 col-sm-12">
                        <label>Village</label>
                        <select name="village" class="form-control" required>
                            <option value="">-- Select Village --</option>
                            {% for v in villages %}
                                <option value="{{ v.id }}">{{ v.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group col-md-6 col-sm-12">
                        <label>Mandal</label>
                        <select name="mandal" class="form-control" required>
                            <option value="">-- Select Mandal --</option>
                            {% for m in mandals %}
                                <option value="{{ m.id }}">{{ m.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group col-md-6 col-sm-12">
                        <label>District</label>
                        <select name="district" class="form-control" required>
                            <option value="">-- Select District --</option>
                            {% for d in districts %}
                                <option value="{{ d.id }}">{{ d.name }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group col-md-6 col-sm-12">
                        <label>Domain</label>
                        <select name="domain" class="form-control" required>
                            <option value="">-- Select Domain --</option>
                            {% for dom in domains %}
                                <option value="{{ dom.id }}">{{ dom.title }}</option>
                            {% endfor %}
                        </select>
                    </div>

                    <div class="form-group col-md-6 col-sm-12">
                        <label>SubDomain</label>
                        <select name="subdomain" id="subdomain-select" class="form-control" required>
                            <option value="">-- Select Sub-Domain --</option>
                            {% for sd in subdomains %}
                                <option value="{{ sd.id }}"
                                        data-domain="{{ sd.domain.id }}"
                                        {% if not sd.is_open %}disabled class="text-muted"{% endif %}>
                                    {{ sd.title }} {% if not sd.is_open %}(Closed){% endif %}
                                </option>
                            {% endfor %}
                        </select>
                    </div>

                </div>

                <!-- Qualification & Comment -->
                <div class="form-group">
                    <label>Qualification</label>
                    <input type="text" name="qualification" class="form-control">
                </div>

                <div class="form-group">
                    <label>Comment</label>
                    <textarea name="comment" class="form-control" rows="3"></textarea>
                </div>

                <!-- Submit Button -->
                <button type="submit" class="btn register-btn btn-block mt-3">Register</button>
            </form>
        </div>
    </div>
</div>

<!-- Styles -->
<style>
/* Modern Card Style */
.registration-card {
    background: #fdfdfd;
    border-radius: 16px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.08);
    margin: 0 auto;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.registration-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 12px 30px rgba(0,0,0,0.12);
}
option[disabled] {
    color: #999;
    background-color: #f5f5f5;
}
/* Card Body Padding */
.registration-card .card-body { padding: 30px; }

/* Card Title */
.card-title { font-weight: bold; color: #0161aa; margin-bottom: 10px; }

/* Inputs and Labels */
.form-group label {
    font-weight: 600;
    display: block;
    margin-bottom: 6px !important; /* override Bootstrap */
}

textarea.form-control {
    min-height: 120px !important;  /* bigger visible area */
    resize: vertical !important;   /* allow resizing */
    border-radius: 8px !important;
    border: 1px solid #ccc !important;
    padding: 10px 12px !important;
}



.form-control {
    border-radius: 8px;
    border: 1px solid #ccc;
   
    transition: all 0.3s ease;
    
}
.form-control:focus {
    border-color: #0161aa;
    box-shadow: 0 0 6px rgba(1,97,170,0.3);
}

/* Button */
.register-btn {
    background: linear-gradient(135deg, #0161aa, #0099ff);
    color: #fff;
    font-weight: bold;
    padding: 12px;
    border-radius: 8px;
    border: none;
    transition: all 0.3s ease;
}
.register-btn:hover {
    background: linear-gradient(135deg, #005a99, #007acc);
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

/* Responsive Adjustments */
@media (max-width: 768px) {
    .registration-card .card-body { padding: 20px; }
    .card-title { font-size: 22px; }
}
@media (max-width: 480px) {
    .card-title { font-size: 18px; }
    .register-btn { font-size: 14px; padding: 10px; }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const domainSelect = document.querySelector('select[name="domain"]');
    const subdomainSelect = document.getElementById('subdomain-select');

    function filterSubdomains() {
        const selectedDomain = domainSelect.value;

        Array.from(subdomainSelect.options).forEach(option => {
            const domainId = option.dataset.domain;
            
            if (!option.value) {
                option.hidden = false; // Keep placeholder visible
            } else if (domainId === selectedDomain) {
                option.hidden = false; // Show only subdomains of selected domain
            } else {
                option.hidden = true;  // Hide others
            }
        });

        subdomainSelect.value = ""; // Reset selection
    }

    domainSelect.addEventListener('change', filterSubdomains);

    // Initial filter in case a domain is pre-selected
    filterSubdomains();
});
</script>


{% endblock %}
