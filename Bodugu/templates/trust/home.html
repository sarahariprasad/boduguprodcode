{% extends "base.html" %}

{% block title %}Home | MyWebsite{% endblock %}

{% block extra_css %}
  <!-- Slick CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"/>

  <style>
/* ===== Banner styles ===== */
.banner-wrapper {
  margin-top: 80px; /* space below navbar */
}

/* Banner images with fixed responsive height */
.carousel-inner > .item > img.banner-img {
  width: 100%;
  height: auto;           /* keeps full image, no cropping */
  max-height: 550px;       /*donâ€™t go taller than 400px */

  display: block;
  border-radius: 10px;
  box-shadow: 0 6px 20px rgba(0,0,0,0.15);
}

/* Desktop size */

@media (min-width: 1200px) {
    .container {
        width: 100%;
        padding: 0px;
    }
    .work-section.row {
      margin-right: 0px;
      margin-left: 0px;
    }
}

/* Tablet size */
@media (max-width: 992px) {
  .carousel-inner > .item > img.banner-img {
    max-height: 280px;
    border-radius: 6px;
  }
}

/* Mobile size */
@media (max-width: 600px) {
  .carousel-inner > .item > img.banner-img {
    max-height: 200px;
    border-radius: 0;
    box-shadow: none;
  }
}

.carousel-caption {
  bottom: 15%;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  background: rgba(0,0,0,0.4);
  padding: 10px 20px;
  border-radius: 6px;
}

.banner-title {
  font-size: 28px;
  font-weight: bold;
  color: #fff;
  text-shadow: 1px 1px 4px rgba(0,0,0,0.7);
  margin: 0;
}

@media (max-width: 768px) {
  .banner-title { font-size: 20px; }
}

.banner-link { color: #fff; text-decoration: none; }
.banner-link:hover { text-decoration: underline; color: #ffd700; }

    /* ===== Latest News slider styles ===== */
    .latest-section { margin-top: 30px; }
    .latest-slick-slider { list-style: none; padding: 0; margin: 20px 0; }
    .latest-slick-slider .element { padding: 10px; height: 100%; }

    .inside-box {
      position: relative; /* needed for ribbon */
      border: 1px solid #e6e6e6;
      border-radius: 8px;
      padding: 15px;
      background: #fff;
      height: 100%;
      transition: all 0.3s ease-in-out;
    }

    .inside-box:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    }

    .img-container {
      width: 100%;
      height: 200px;
      overflow: hidden;
      border-radius: 6px;
      background: #f9f9f9;
    }
    .img-container img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .inside-box h4 {
      margin: 10px 0 8px;
      font-size: 18px;
      line-height: 1.3;
      color: #222;
    }

    /* Clamp for short description */
    .short-clamp {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 13px;
      color: #666;
      margin-bottom: 5px;
      line-height: 1.4;
      min-height: 38px;
    }

    /* Clamp for full description */
    .clamp-text {
      display: -webkit-box;
      -webkit-line-clamp: 3;
      line-clamp: 3;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 14px;
      color: #444;
      line-height: 1.4;
      min-height: 60px;
    }

    /* Clamp for title */
    .title-clamp {
      display: -webkit-box;
      -webkit-line-clamp: 2;
      line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 18px;
      line-height: 1.3;
      color: #222;
      min-height: 46px;
    }

    .readMoreBtn {
      display: inline-block;
      background: #007bff;
      color: #fff;
      padding: 6px 14px;
      border-radius: 20px;
      font-size: 13px;
      text-decoration: none;
      margin-top: 10px;
      align-self: flex-start;
      transition: background 0.3s;
    }
    .readMoreBtn:hover {
      background: #0056b3;
      color: #fff;
      text-decoration: none;
    }

    .card {
      border: 1px solid #e6e6e6;
      border-radius: 8px;
      transition: all 0.3s ease-in-out;
    }

    .card:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: 0 10px 20px rgba(0,0,0,0.15);
    }

    /* Straight Folded Ribbon (top-right corner) */
    .ribbon {
      position: absolute;
      top: 15px;
      right: -10px;
      background: #ae0b06;
      color: #fff;
      font-size: 12px;
      font-weight: bold;
      padding: 5px 15px;
      text-transform: uppercase;
      border-radius: 2px 0 0 2px;
      box-shadow: 0 2px 6px rgba(156, 150, 150, 0.2);
      z-index: 10;
    }
    .ribbon::after {
      content: "";
      position: absolute;
      right: 0;
      bottom: -5px;
      border-right: 5px solid #820606;
      border-top: 5px solid transparent;
    }

    /* Slick arrows color tweak */
    .slick-prev:before, .slick-next:before { color: #333; }
    .slick-dots li button:before { color: #666; }
    .slick-dots li.slick-active button:before { color: #007bff; }

    /* ===== Areas of Work Card Styles ===== */
    .work-card {
      position: relative;
      overflow: hidden;
      border-radius: 8px;
      cursor: pointer;
    }

    .work-card img {
      width: 100%;
      height: 250px;
      object-fit: cover;
      display: block;
      transition: transform 0.5s ease;
    }

    /* Slight zoom on hover */
    .work-card:hover img {
      transform: scale(1.1);
    }

    /* Always visible title (bottom-left) */
    .work-title {
      position: absolute;
      bottom: 10px;
      left: 10px;
      background: rgba(0,0,0,0.6);
      color: #fff;
      padding: 5px 12px;
      font-size: 16px;
      font-weight: bold;
      border-radius: 4px;
      z-index: 2;
    }

    /* Overlay initially hidden */
    .work-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      color: #fff;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      transform: scale(0);
      transform-origin: left bottom;
      transition: transform 0.4s ease-in-out, background 0.3s ease;
      padding: 20px;
      z-index: 3;
    }

    .work-card:hover .work-overlay {
      transform: scale(1);
    }

    .overlay-content h3 {
      margin: 0 0 10px;
      font-size: 22px;
      font-weight: bold;
    }
    .overlay-content .btn {
      background: #fff;
      color: #007bff;
      border-radius: 20px;
      padding: 6px 14px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    .overlay-content .btn:hover {
      background: #0056b3;
      color: #fff;
    }

    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
{% endblock %}

{% block content %}

  <!-- ===== Banner Carousel ===== -->
  <div class="container-fluid banner-wrapper" style="padding:0;">
    <div id="bannerCarousel" class="carousel slide carousel-fade" data-ride="carousel" data-interval="4000">
      <!-- Indicators -->
      <ol class="carousel-indicators">
        {% for banner in homebanner %}
          <li data-target="#bannerCarousel"
              data-slide-to="{{ forloop.counter0 }}"
              class="{% if forloop.first %}active{% endif %}"></li>
        {% endfor %}
      </ol>

      <!-- Slides -->
      <div class="carousel-inner" role="listbox">
        {% for banner in homebanner %}
          <div class="item {% if forloop.first %}active{% endif %}">
            <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-img">
            <div class="carousel-caption animated-caption">
              <h2 class="banner-title">
                {% if banner.link %}
                  <a href="{{ banner.link }}" class="banner-link">{{ banner.title }}</a>
                {% else %}
                  {{ banner.title }}
                {% endif %}
              </h2>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Controls -->
      <a class="left carousel-control" href="#bannerCarousel" role="button" data-slide="prev">
        <span class="glyphicon glyphicon-chevron-left"></span>
      </a>
      <a class="right carousel-control" href="#bannerCarousel" role="button" data-slide="next">
        <span class="glyphicon glyphicon-chevron-right"></span>
      </a>
    </div>
  </div>

  <!-- ===== Latest News (Slick Slider) ===== -->
  <div class="container latest-section">
    <h2 class="text-center">Latest News</h2>
    <ul class="latest-slick-slider">
      {% for news in latestnews %}
        <li class="element">
          <div class="inside-box">

            {% if news.sticker %}
              <span class="ribbon">{{ news.sticker }}</span>
            {% endif %}

            {% if news.image %}
              <div class="img-container">
                <img src="{{ news.image.url }}" alt="{{ news.title }}">
              </div>
            {% endif %}

            <h4 class="title-clamp">{{ news.title }}</h4>
            {% if news.short_description %}
              <p class="short-clamp">{{ news.short_description }}</p>
            {% endif %}
            <p class="clamp-text">{{ news.description|truncatewords:30 }}</p>

            <a href="{{ news.get_absolute_url }}" class="readMoreBtn"><span>Read more</span></a>
          </div>
        </li>
      {% empty %}
        <li><em>No news available.</em></li>
      {% endfor %}
    </ul>
  </div>

  <!-- ===== Areas of Work ===== -->
  <div class="container" style="margin-top:10px;">
    <h1 class="text-center">Areas of Work</h1>
    <div class="work-section row justify-content-center">
      {% for area in areas %}
        <div class="col-md-4 col-sm-6" style="margin-bottom:20px;">
          <div class="work-card">
            {% if area.banner_image %}
              <img src="{{ area.banner_image.url }}" alt="{{ area.title }}">
            {% endif %}
            <div class="work-title">{{ area.title }}</div>
            <div class="work-overlay">
              <div class="overlay-content">
                <h3>{{ area.title }}</h3>
                <a href="{{ area.get_absolute_url }}" class="btn btn-light">Explore</a>
              </div>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
{% endblock %}

{% block extra_js %}
  <!-- Slick JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <script>
    (function($){
      $(function(){
        var $slider = $('.latest-slick-slider');
        if ($slider.length && !$slider.hasClass('slick-initialized')) {
          $slider.slick({
            infinite: true,
            slidesToShow: 3,
            slidesToScroll: 1,
            dots: true,
            arrows: true,
            autoplay: true,
            autoplaySpeed: 3000,
            speed: 800,
            pauseOnHover: true,
            pauseOnFocus: true,
            adaptiveHeight: false,
            responsive: [
              { breakpoint: 992, settings: { slidesToShow: 2 } },
              { breakpoint: 768, settings: { slidesToShow: 1 } }
            ]
          });
        }
      });
    })(jQuery);
  </script>
  <script>
    /* Assign random overlay colors on hover */
    document.addEventListener("DOMContentLoaded", function () {
      const colors = [
        "rgba(0,128,0,0.8)",   // green
        "rgba(255,140,0,0.8)", // orange
        "rgba(220,20,60,0.8)", // crimson
        "rgba(30,144,255,0.8)",// dodgerblue
        "rgba(128,0,128,0.8)", // purple
        "rgba(255,0,0,0.7)"    // red
      ];
      
      document.querySelectorAll(".work-card").forEach(card => {
        const overlay = card.querySelector(".work-overlay");
        card.addEventListener("mouseenter", () => {
          const randomColor = colors[Math.floor(Math.random() * colors.length)];
          overlay.style.background = randomColor;
        });
      });
    });
  </script>
{% endblock %}
